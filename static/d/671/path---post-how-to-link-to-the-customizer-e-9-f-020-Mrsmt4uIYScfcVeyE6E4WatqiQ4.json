{"data":{"mdx":{"id":"0372f423-b47a-5c69-b974-c6459ba0247e","excerpt":"I recently needed to link to a custom panel in the Customizer and had to figure it out.  Devin Price  pointed me in the right direction, but I ended up looking…","frontmatter":{"title":"How to Link to the Customizer","date":"June 02, 2016","category":["Code Samples"],"featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBP/EABYBAQEBAAAAAAAAAAAAAAAAAAMAAv/aAAwDAQACEAMQAAAB3Q2S0QW//8QAGxAAAgIDAQAAAAAAAAAAAAAAAAECERIhIjH/2gAIAQEAAQUCvlyFIXq2Z0f/xAAWEQEBAQAAAAAAAAAAAAAAAAAAETH/2gAIAQMBAT8BxH//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAYEAADAQEAAAAAAAAAAAAAAAAAASEQEf/aAAgBAQAGPwJzLj6RI//EABsQAAIDAAMAAAAAAAAAAAAAAAABESExQVFx/9oACAEBAAE/Ie8rBz8ip5EpUUknoSOjG9bF4f/aAAwDAQACAAMAAAAQx+//xAAZEQADAAMAAAAAAAAAAAAAAAAAARExQaH/2gAIAQMBAT8Qd0Fax0//xAAXEQEBAQEAAAAAAAAAAAAAAAABABEh/9oACAECAQE/EBE27f/EABsQAQEAAwEBAQAAAAAAAAAAAAERACFBMXGh/9oACAEBAAE/EAiPBXrv8cbQ0rRE2CXnzB47vZkNoXbAinZgKJZVT3uTxyla3XP/2Q==","aspectRatio":1.5051740357478833,"src":"/static/52efd9e120a424fd70e1613c5ab87c16/81ef8/scott-webb-51466-unsplash.jpg","srcSet":"/static/52efd9e120a424fd70e1613c5ab87c16/c83a6/scott-webb-51466-unsplash.jpg 300w,\n/static/52efd9e120a424fd70e1613c5ab87c16/775d9/scott-webb-51466-unsplash.jpg 600w,\n/static/52efd9e120a424fd70e1613c5ab87c16/81ef8/scott-webb-51466-unsplash.jpg 1200w,\n/static/52efd9e120a424fd70e1613c5ab87c16/989b1/scott-webb-51466-unsplash.jpg 1600w","sizes":"(max-width: 1200px) 100vw, 1200px"}}},"featuredImageAccount":"scottwebb","featuredImagePhotographer":"Scott Webb"},"code":{"body":"function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nconst layoutProps = {};\nreturn class MDXContent extends React.Component {\n  constructor(props) {\n    super(props);\n    this.layout = null;\n  }\n\n  render() {\n    const _this$props = this.props,\n          {\n      components\n    } = _this$props,\n          props = _objectWithoutProperties(_this$props, [\"components\"]);\n\n    return React.createElement(MDXTag, {\n      name: \"wrapper\",\n      components: components\n    }, React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `I recently needed to link to a custom panel in the Customizer and had to figure it out. `, React.createElement(MDXTag, {\n      name: \"a\",\n      components: components,\n      parentName: \"p\",\n      props: {\n        \"href\": \"http://wptheming.com/2015/01/link-to-customizer-sections/\"\n      }\n    }, `Devin Price`), ` pointed me in the right direction, but I ended up looking in the WordPress core to see how they do it and this is how.`), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `This a simple link to Customizer:`), React.createElement(MDXTag, {\n      name: \"pre\",\n      components: components\n    }, React.createElement(MDXTag, {\n      name: \"code\",\n      components: components,\n      parentName: \"pre\",\n      props: {\n        \"className\": \"language-php\"\n      }\n    }, `<a href=\"<?php echo esc_url( admin_url( 'customize.php' ) ); ?>\">Link to Customizer</a>\n`)), React.createElement(MDXTag, {\n      name: \"h2\",\n      components: components\n    }, `Linking to Panels, Sections, and Controls in the Customizer`), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `If you want to link to a specific panel in the Customizer, you’ll want to use this:`), React.createElement(MDXTag, {\n      name: \"pre\",\n      components: components\n    }, React.createElement(MDXTag, {\n      name: \"code\",\n      components: components,\n      parentName: \"pre\",\n      props: {\n        \"className\": \"language-php\"\n      }\n    }, `\\$query['autofocus[panel]'] = 'nav_menus';\n\n\\$panel_link = add_query_arg( \\$query, admin_url( 'customize.php' ) );\n\n?><a href=\"<?php echo esc_url( \\$panel_link ); ?>\">Link to Panel</a>\n`)), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `If you aren’t familiar with `, React.createElement(MDXTag, {\n      name: \"a\",\n      components: components,\n      parentName: \"p\",\n      props: {\n        \"href\": \"https://developer.wordpress.org/reference/functions/add_query_arg/\"\n      }\n    }, `add_query_args`), `, its worth reading up on it. I learned about it from `, React.createElement(MDXTag, {\n      name: \"a\",\n      components: components,\n      parentName: \"p\",\n      props: {\n        \"href\": \"https://twitter.com/fklux\"\n      }\n    }, `Fränk Klein`), ` for how to properly `, React.createElement(MDXTag, {\n      name: \"a\",\n      components: components,\n      parentName: \"p\",\n      props: {\n        \"href\": \"https://themeshaper.com/2014/08/13/how-to-add-google-fonts-to-wordpress-themes/\"\n      }\n    }, `add Google Fonts to WordPress`), `. `, React.createElement(MDXTag, {\n      name: \"a\",\n      components: components,\n      parentName: \"p\",\n      props: {\n        \"href\": \"https://pippinsplugins.com/\"\n      }\n    }, `Pippin Williamson`), ` also has a good post about write-up about `, React.createElement(MDXTag, {\n      name: \"a\",\n      components: components,\n      parentName: \"p\",\n      props: {\n        \"href\": \"https://pippinsplugins.com/the-add_query_arg-helper-function/\"\n      }\n    }, `using add_query_args`), ` too. We’ll see later how you can use it to create more advanced links into the Customizer.`), React.createElement(MDXTag, {\n      name: \"h3\",\n      components: components\n    }, `Security Warning!`), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `One warning: always specify the URL parameter and always escape the output. The core developers `, React.createElement(MDXTag, {\n      name: \"a\",\n      components: components,\n      parentName: \"p\",\n      props: {\n        \"href\": \"https://make.wordpress.org/plugins/2015/04/20/fixing-add_query_arg-and-remove_query_arg-usage/\"\n      }\n    }, `discussed this issue`), ` in April of 2015. If you don’t specify the URL and don’t escape the output of this function, then someone might be able to use it as a XSS attack vector. If you’ll notice, I’m including the `, React.createElement(MDXTag, {\n      name: \"a\",\n      components: components,\n      parentName: \"p\",\n      props: {\n        \"href\": \"https://developer.wordpress.org/reference/functions/esc_url/\"\n      }\n    }, `esc_url()`), ` function in the output of each of the examples above and the URL parameter is specified too.`), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `In the \\$query array, the key tells the Customizer what to do, then the value tells it where we’re going. From the example above: autofocus in a panel called “nav_menus”.`), React.createElement(MDXTag, {\n      name: \"h3\",\n      components: components\n    }, `Panel Options`), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `You can change the value to the panel of your choice. Here’s a list of the default panels included in WordPress (as of version 4.5.2):`), React.createElement(MDXTag, {\n      name: \"ul\",\n      components: components\n    }, React.createElement(MDXTag, {\n      name: \"li\",\n      components: components,\n      parentName: \"ul\"\n    }, `widgets = Widget panel`), React.createElement(MDXTag, {\n      name: \"li\",\n      components: components,\n      parentName: \"ul\"\n    }, `nav_menus = Menus panel`)), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `If you want to link to a section instead, you can change part of the key:`), React.createElement(MDXTag, {\n      name: \"pre\",\n      components: components\n    }, React.createElement(MDXTag, {\n      name: \"code\",\n      components: components,\n      parentName: \"pre\",\n      props: {\n        \"className\": \"language-php\"\n      }\n    }, `\\$query['autofocus[section]'] = 'title_tagline';\n\n\\$section_link = add_query_arg( \\$query, admin_url( 'customize.php' ) );\n\n?><a href=\"<?php echo esc_url( \\$section_link ); ?>\">Link to Section</a>\n`)), React.createElement(MDXTag, {\n      name: \"h3\",\n      components: components\n    }, `Section Options`), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `Here are the IDs for the default sections in WordPress:`), React.createElement(MDXTag, {\n      name: \"ul\",\n      components: components\n    }, React.createElement(MDXTag, {\n      name: \"li\",\n      components: components,\n      parentName: \"ul\"\n    }, `static_front_page = Static Front Page section`), React.createElement(MDXTag, {\n      name: \"li\",\n      components: components,\n      parentName: \"ul\"\n    }, `title_tagline = Site Identity section`)), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `Some of the default themes like Twenty Sixteen add their own sections and any theme can add the following sections by declaring theme support for them:`), React.createElement(MDXTag, {\n      name: \"ul\",\n      components: components\n    }, React.createElement(MDXTag, {\n      name: \"li\",\n      components: components,\n      parentName: \"ul\"\n    }, `background_image = Background Image section`), React.createElement(MDXTag, {\n      name: \"li\",\n      components: components,\n      parentName: \"ul\"\n    }, `header_image = Header Image section`)), React.createElement(MDXTag, {\n      name: \"h3\",\n      components: components\n    }, `Field Options`), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `The real magic is linking to the customizer and autofocusing on a specific field (aka control):`), React.createElement(MDXTag, {\n      name: \"pre\",\n      components: components\n    }, React.createElement(MDXTag, {\n      name: \"code\",\n      components: components,\n      parentName: \"pre\",\n      props: {\n        \"className\": \"language-php\"\n      }\n    }, `\\$query['autofocus[control]'] = 'blogname';\n\n\\$control_link = add_query_arg( \\$query, admin_url( 'customize.php' ) );\n\n?><a href=\"<?php echo esc_url( \\$control_link ); ?>\">Link to Control</a>\n`)), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `This links to the Site Title field in the Site Identity section. If you’re asking people to go to a specific place and make an edit, go ahead and link this way to make it easier.`), React.createElement(MDXTag, {\n      name: \"h2\",\n      components: components\n    }, `After the Customizer`), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `In addition to linking to somewhere within the Customizer, you can also specify where to go after you exit. Core uses the page you’re currently on by default. You can check the link to the Customizer from different places in the admin and see that return value changes.`), React.createElement(MDXTag, {\n      name: \"pre\",\n      components: components\n    }, React.createElement(MDXTag, {\n      name: \"code\",\n      components: components,\n      parentName: \"pre\",\n      props: {\n        \"className\": \"language-php\"\n      }\n    }, `\\$query['return'] = admin_url();\n\n\\$link_with_return = add_query_arg( \\$query, admin_url( 'customize.php' ) );\n`)), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `That will link to the Customizer and return you to the Dashboard.`), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `FYI, you cannot specify any old URL to go to afterward. For instance, this does not work:`), React.createElement(MDXTag, {\n      name: \"pre\",\n      components: components\n    }, React.createElement(MDXTag, {\n      name: \"code\",\n      components: components,\n      parentName: \"pre\",\n      props: {\n        \"className\": \"language-php\"\n      }\n    }, `\\$query['return'] = 'https://www.cnn.com';\n\n\\$link = add_query_arg( \\$query, admin_url( 'customize.php' ) );\n\n?><a href=\"<?php echo esc_url( \\$link ); ?>\">Go to CNN after</a>\n`)), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `The Customizer runs these return URLs through the function `, React.createElement(MDXTag, {\n      name: \"a\",\n      components: components,\n      parentName: \"p\",\n      props: {\n        \"href\": \"https://developer.wordpress.org/reference/functions/wp_validate_redirect/\"\n      }\n    }, `wp_validate_redirect()`), `. By default, the only allowed URL is the `, React.createElement(MDXTag, {\n      name: \"a\",\n      components: components,\n      parentName: \"p\",\n      props: {\n        \"href\": \"https://developer.wordpress.org/reference/functions/home_url/\"\n      }\n    }, `home_url()`), `. Additional URLs can be added using the `, React.createElement(MDXTag, {\n      name: \"a\",\n      components: components,\n      parentName: \"p\",\n      props: {\n        \"href\": \"https://developer.wordpress.org/reference/hooks/allowed_redirect_hosts/\"\n      }\n    }, `allowed_redirect_hosts()`), ` filter. The wp_validate_redirect() function is used for many parts of WordPress, so I’d advise caution when adding URLs to this allowed list.`), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `Now, we can build more specific URLs for the Customizer. This could be especially useful if you’re walking a site admin through performing several steps:`), React.createElement(MDXTag, {\n      name: \"pre\",\n      components: components\n    }, React.createElement(MDXTag, {\n      name: \"code\",\n      components: components,\n      parentName: \"pre\",\n      props: {\n        \"className\": \"language-php\"\n      }\n    }, `\\$query['autofocus[control]'] = 'blogname';\n\n\\$query['return'] = admin_url( 'post-new.php' );\n\n\\$link = add_query_arg( \\$query, admin_url( 'customize.php' ) );\n\n?><a href=\"<?php echo esc_url( \\$link ); ?>\">Set title, then write post</a>\n`)), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `This links into the Customizer, autofocuses on the Site Title field, then once you’re done, takes you to the new post page.`), React.createElement(MDXTag, {\n      name: \"h2\",\n      components: components\n    }, `Set the Preview Page`), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `If you have Customizer controls that only apply to specific pages, you can specify which page appears in the previewer:`), React.createElement(MDXTag, {\n      name: \"pre\",\n      components: components\n    }, React.createElement(MDXTag, {\n      name: \"code\",\n      components: components,\n      parentName: \"pre\",\n      props: {\n        \"className\": \"language-php\"\n      }\n    }, `\\$query['url'] = site_url( '/news' );\n\n\\$link = add_query_arg( \\$query, admin_url( 'customize.php' ) );\n\n?><a href=\"<?php echo esc_url( \\$link ); ?>\">News Page in Preview</a>\n`)), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `In this case, the Previewer will display the News page instead of the home page. I’m planning to do additional testing to see if this could be used to style a plugin-specific page.`), React.createElement(MDXTag, {\n      name: \"h2\",\n      components: components\n    }, `All Together Now!`), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `Those are all the parameters currently available for the Customizer. Now you can get really crazy (and specific) about your links to the Customizer. For example, go to the Menu Locations, show the About page in the previewer, then when you’re done, add a new page:`), React.createElement(MDXTag, {\n      name: \"pre\",\n      components: components\n    }, React.createElement(MDXTag, {\n      name: \"code\",\n      components: components,\n      parentName: \"pre\",\n      props: {\n        \"className\": \"language-php\"\n      }\n    }, `\\$query['autofocus[section]'] = 'menu_locations';\n\\$query['return'] = admin_url( 'post-new.php?post_type=page' );\n\\$query['url'] = site_url( '/about-us' );\n\n\\$link = add_query_arg( \\$query, admin_url( 'customize.php' ) );\n\n?><a href=\"<?php echo esc_url( \\$link ); ?>\">Craziness!</a>\n`)), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `To wrap up, there are three parameters you can use to link into the customizer: return, url, and autofocus. Use add_query_arg to build the URL and esc_url to display it. The autofocus parameter lets you focus on a panel, a section, or a specific field. Then the url parameter lets you display a specific page in the Previewer. You can use the return parameter to go to a particular place after going to the Customizer. Happy linking!`), React.createElement(MDXTag, {\n      name: \"p\",\n      components: components\n    }, `Here’s a `, React.createElement(MDXTag, {\n      name: \"a\",\n      components: components,\n      parentName: \"p\",\n      props: {\n        \"href\": \"https://gist.github.com/slushman/6f08885853d4a7ef31ebceafd9e0c180\"\n      }\n    }, `gist of all the code`), `, if you prefer that.`));\n  }\n\n}"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/post/how-to-link-to-the-customizer/","previous":{"id":"8690e3eb-602a-5b86-929f-22d984268738","fields":{"slug":"/post/how-to-change-the-featured-image-labels/"},"frontmatter":{"title":"How to Change the Featured Image Labels","gallery":null,"category":["Code Samples"]},"code":{"scope":""}},"next":{"id":"c75cc2c2-5039-54e1-b0bc-f2a32c9aefb7","fields":{"slug":"/post/add-select-menu-formidable-forms-customizer/"},"frontmatter":{"title":"How to Add a Select Menu of Formidable Forms in Customizer","gallery":null,"category":["Code Samples"]},"code":{"scope":""}}}}